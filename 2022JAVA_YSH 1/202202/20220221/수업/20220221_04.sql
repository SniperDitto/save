SELECT * FROM PROFESSORS;

--교수의 나이를 구해보자 -- 우리나라나이
SELECT BIRTH, SUBSTR(BIRTH, 1, 4) AS BIRTHYEAR, SUBSTR(SYSDATE, 1, 4) NOWYEAR,
TO_CHAR(SYSDATE, 'YYYY'), TO_CHAR(SYSDATE, 'YYYY') - SUBSTR(BIRTH, 1, 4) + 1 AS PAGE
FROM PROFESSORS;

--1. 10대, 20대, 30대, 40대, 50대 60대, 70대, .... COUNT(*)
SELECT BIRTH, SUBSTR(TRIM(BIRTH), 1, 4) AS BIRTHYEAR,
              TO_CHAR(TO_DATE(BIRTH, 'YYYYMMDD'), 'YYYY') AS BIRTHYEAR2,
              TO_CHAR(SYSDATE, 'YYYY') AS NOWYEAR,
              TO_CHAR(SYSDATE, 'YYYY') - TO_CHAR(TO_DATE(BIRTH, 'YYYYMMDD'), 'YYYY') AS PAGE,
              --40대, 50대 60대......
              TRUNC(TO_CHAR(SYSDATE, 'YYYY') - TO_CHAR(TO_DATE(BIRTH, 'YYYYMMDD'), 'YYYY'), -1)
FROM PROFESSORS;

SELECT TRUNC(TO_CHAR(SYSDATE, 'YYYY') - TO_CHAR(TO_DATE(BIRTH, 'YYYYMMDD'), 'YYYY'), -1), COUNT(*)
FROM PROFESSORS
GROUP BY TRUNC(TO_CHAR(SYSDATE, 'YYYY') - TO_CHAR(TO_DATE(BIRTH, 'YYYYMMDD'), 'YYYY'), -1)
ORDER BY TRUNC(TO_CHAR(SYSDATE, 'YYYY') - TO_CHAR(TO_DATE(BIRTH, 'YYYYMMDD'), 'YYYY'), -1) ASC
;

/*
1910 ~ 1919  
1920 ~ 1929
1930 ~ 1939
1940 ~ 1949
1950 ~ 1959
1960 ~ 1969
1970 ~ 1979
1980 ~ 1989
1990 ~ 1999
2000 ~ 2009
2010 ~ 2019
2020 ~ 현재
*/


--19730604      1970 ~ 1979
SELECT BIRTH, SUBSTR(BIRTH, 1, 3) || '0 ~ ' || SUBSTR(BIRTH, 1, 3) || '9' FROM PROFESSORS
--GROUP BY SUBSTR(BIRTH, 1, 3) || '0 ~ ' || SUBSTR(BIRTH, 1, 3) || '9'
;
SELECT SUBSTR(BIRTH, 1, 3) || '0 ~ ' || SUBSTR(BIRTH, 1, 3) || '9' FROM PROFESSORS
GROUP BY SUBSTR(BIRTH, 1, 3) || '0 ~ ' || SUBSTR(BIRTH, 1, 3) || '9'
;

SELECT LEVEL || ' ~ ' || (LEVEL * 10 - 1)
FROM DUAL
CONNECT BY LEVEL <= 10
;

SELECT * FROM PROFESSORS;

/*
191
192
193
194
195
196
197
198
199
200
201
202
*/

--메모리상에 존재하는 테이블을 VIEW
SELECT  A.BASICYEAR, NVL(B.CNT, 0) AS CNT FROM
(
    SELECT 190 + LEVEL || '0' AS BASICYEAR
    FROM DUAL
    CONNECT BY LEVEL <= 12
) A
,
(
    SELECT SUBSTR(TRIM(BIRTH), 1, 3) || '0' BIRTHYEAR, COUNT(*) AS CNT
    FROM PROFESSORS
    GROUP BY SUBSTR(TRIM(BIRTH), 1, 3) || '0'
) B
WHERE A.BASICYEAR = B.BIRTHYEAR(+)
ORDER BY A.BASICYEAR ASC
;

